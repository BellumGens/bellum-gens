
<div class="player-overview">
  <igx-card>
    <igx-card-header *ngIf="player">
        <igx-avatar [src]="player.steamUser.avatarFull" roundShape="true" [size]="'large'">
          <igx-avatar *ngIf="player.steamUser.country" [src]="'assets/country-flags/svg/' + player.steamUser.country.toLowerCase() + '.svg'" [title]="player.steamUser.country" class="country-badge-large"></igx-avatar>
        </igx-avatar>
        <div class="player__info">
          <h1 class="igx-card-header__title"><a [href]="'https://steamcommunity.com/id/' + player.steamUser.customURL" target="_blank">{{ player.steamUser.steamID }}</a></h1>
          <h3 class="igx-card-header__subtitle">{{ player.steamUser.realname }}</h3>
        </div>
        <div *ngIf="player.userStats" class="player-stats__container">
          <div class="player-detail__stats">
            <h3 class="no-margin">KDR:</h3>
            <igx-circular-bar class="stats-progress" [value]="player.userStats.killDeathRatio" [max]="2" [animate]="true" title="KDR" [text]="player.userStats.killDeathRatio"></igx-circular-bar>
          </div>
          <div class="player-detail__stats">
            <h3 class="no-margin">Headshots:</h3>
            <igx-circular-bar class="stats-progress" [value]="player.userStats.headshotPercentage" [max]="100" [animate]="true" title="Headshot Percentage" [text]="player.userStats.headshotPercentage + '%'"></igx-circular-bar>
          </div>
          <div class="player-detail__stats">
            <h3 class="no-margin">Accuracy:</h3>
            <igx-circular-bar class="stats-progress" [value]="player.userStats.accuracy" [max]="100" [animate]="true" [text]="player.userStats.accuracy + '%'"></igx-circular-bar>
          </div>
          <div class="player-detail__stats">
              <h3 class="no-margin">Top Weapon:</h3>
              <img [src]="'assets/weapon-icons/svg_normal/weapon_' + player.userStats.favouriteWeapon.name + '.svg'"
                  [alt]="'Top Weapon with ' + player.userStats.favouriteWeapon.kills + ' kills: ' + player.userStats.favouriteWeapon.name"
                  [title]="player.userStats.favouriteWeapon.kills + ' kills'" /> 
          </div>
          <div *ngIf="playerIsUser() && player.userStatsException" class="player-stats__container">
            <h3>Your Steam account is private.</h3>
            <p>In order to allow us to retrieve your ingame statistics, you need to change the privacy level of your account, so we can access them from Steam.</p>
            <p>To do this go to Steam Profile --> Edit Profile --> Privacy Settings --> Set: 'My profile: Public' and 'Game details: public'</p>
          </div>
          <!-- <div class="player-detail__stats">
            <img src="assets/csgo-ranks/status-icons/skillgroup14.png" alt="rank" />
          </div> -->
        </div>
    </igx-card-header>
    <igx-card-content *ngIf="player">

<!-- Playstyle Roles -->
      <div class="player-stats__container">
        <div class="player-detail__stats">
            <h4 class="no-margin">Preferred Primary Role:</h4>
            <h4 *ngIf="!playerIsUser()">{{ player.roles[player.primaryRole].Name }}</h4>
            <button igxButton="flat" *ngIf="playerIsUser()" [igxToggleAction]="primaryRole" igxRippleCentered="true">
              {{ player.roles[player.primaryRole].Name }}
              <igx-icon fontSet="material" name="arrow_drop_down"></igx-icon>
            </button>
            <igx-drop-down #primaryRole (onSelection)="selectPrimary($event)">
              <igx-drop-down-item *ngFor="let role of player.roles" [isSelected]="role.Id === player.primaryRole">
                {{ role.Name }}
              </igx-drop-down-item>
            </igx-drop-down>
        </div>
        <div class="player-detail__stats">
            <h4 class="no-margin">Preferred Secondary Role:</h4>
            <h4 *ngIf="!playerIsUser()">{{ player.roles[player.secondaryRole].Name }}</h4>
            <button igxButton="flat" *ngIf="playerIsUser()" [igxToggleAction]="secondaryRole" igxRippleCentered="true">
              {{ player.roles[player.secondaryRole].Name }}
              <igx-icon fontSet="material" name="arrow_drop_down"></igx-icon>
            </button>
            <igx-drop-down #secondaryRole (onSelection)="selectSecondary($event)">
              <igx-drop-down-item *ngFor="let role of player.roles" [isSelected]="role.Id === player.secondaryRole">
                  {{ role.Name }}
              </igx-drop-down-item>
            </igx-drop-down>
        </div>
      </div>
<!-- END Playstyle Roles -->

<!-- Availability -->
      <div *ngIf="player.availability">
        <p class="igx-card-content__text">Availability:</p>
        <igx-chips-area>
            <igx-chip *ngFor="let weekday of player.availability" [selectable]="playerIsUser()" (onSelection)="daySelected($event)">
                <span class='igx-chip__text'>{{ dayName(weekday.Day) }}</span>
                <span class='igx-chip__subtext' *ngIf="weekday.Available">{{ getTime(weekday.From) }}-{{ getTime(weekday.To) }}</span>
            </igx-chip>
        </igx-chips-area>
        <p *ngIf="playerIsUser() && selectedDay" class="igx-card-content__text">Available times for <span class="highlight" [textContent]="selectedDay ? dayName(selectedDay.Day) : ''"></span>:</p>
        <div class="availability-time" *ngIf="playerIsUser() && selectedDay">
          <igx-time-picker #from class="player__info" [disabled]="!playerIsUser()" [value]="dateFromString(this.selectedDay.From)" [itemsDelta]="{hours: 1, minutes: 15}" (onValueChanged)="fromChange($event)">
            
          </igx-time-picker>
          <igx-time-picker #to class="player__info" [disabled]="!playerIsUser()" [value]="dateFromString(this.selectedDay.To)" [itemsDelta]="{hours: 1, minutes: 15}" (onValueChanged)="toChange($event)">
            
          </igx-time-picker>
        </div>
      </div>
<!-- END Availability -->

<!-- Map Pool -->
      <div *ngIf="player">
          <p class="igx-card-content__text">Maps Played:</p>
          <div class="card-wrapper">
              <div class="map-column map-wrapper" *ngFor="let map of activeDuty">
                <igx-card>
                  <img width="100%" height="100%" [src]="map.image" [alt]="map.map" />
                  <igx-card-actions>
                      {{ map.map }}
                      <div class="igx-card-actions__igroup--end">
                        <igx-checkbox checked="false"></igx-checkbox>
                      </div>
                  </igx-card-actions>
                </igx-card>
              </div>
          </div>
        </div>
  <!-- END Map Pool -->

    </igx-card-content>
  </igx-card>
  <igx-toast #error message="Account is private!"></igx-toast>
</div>