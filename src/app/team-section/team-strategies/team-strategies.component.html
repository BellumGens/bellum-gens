<div class="card-with-margins">
  <app-map-pool [mapPool]="maps" [readOnly]="false" (update)="changeMaps($event)"></app-map-pool>
  <div class="horizontal">
    <div class="card-column-2">
      <igx-card>
        <igx-card-content>
          <button igxButton="raised" igxRipple (click)="openNewStrategy(0)">Add new T-Side strategy</button>
        </igx-card-content>
      </igx-card>
      <igx-card *ngFor="let strat of teamStrats | sidestrats:0">
        <igx-card-header>
          <h5>{{ strat.Title }}</h5>
        </igx-card-header>
        <igx-card-content>
          <p>{{ strat.Description }}</p>
          <iframe width="560" height="315" *ngIf="strat.Url" [src]="getYoutubeEmbedLink(strat.Url)" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </igx-card-content>
      </igx-card>
    </div>
    <div class="card-column-2">
      <igx-card>
        <igx-card-content>
          <button igxButton="raised" igxRipple (click)="openNewStrategy(1)">Add new CT-Side strategy</button>
        </igx-card-content>
      </igx-card>
      <igx-card *ngFor="let strat of teamStrats | sidestrats:1">
          <igx-card-content>
            <p>{{ strat.Description }}</p>
          </igx-card-content>
        </igx-card>
    </div>
  </div>
</div>

<!-- New strategy dialog-->
<igx-dialog #newStrat closeOnOutsideSelect="true">
  <div class="new-strategy">
    <igx-list>
      <igx-list-item [isHeader]="true">Add a new team strategy</igx-list-item>
      <igx-list-item>
        <igx-input-group>
          <input #strategyName igxInput placeholder="Strategy title" minlength="2" required [(ngModel)]="newStrategy.Title">
          <igx-suffix *ngIf="strategyName.value.length > 0" (click)="newStrategy.Title = ''">
              <igx-icon>clear</igx-icon>
          </igx-suffix>
        </igx-input-group>
      </igx-list-item>
      <igx-list-item>
        <igx-input-group>
          <textarea #strategyDescription igxInput placeholder="Add strategy description" minlength="2" required [(ngModel)]="newStrategy.Description">
          </textarea>
          <igx-suffix *ngIf="strategyDescription.value.length > 0" (click)="newStrategy.Description = ''">
              <igx-icon>clear</igx-icon>
          </igx-suffix>
        </igx-input-group>
      </igx-list-item>
      <igx-list-item>
        <button igxButton="flat" [igxToggleAction]="mapPicker" igxRippleCentered="true">
          Map: {{ newStrategy.Map | mapname }}
          <igx-icon fontSet="material">arrow_drop_down</igx-icon>
        </button>
        <igx-drop-down #mapPicker (onSelection)="selectMap($event)">
          <igx-drop-down-item *ngFor="let map of mapList" [value]="map.id" [isSelected]="map.id === newStrategy.Map">
            {{ map.map }}
          </igx-drop-down-item>
        </igx-drop-down>
      </igx-list-item>
      <igx-list-item>
        <igx-input-group>
          <igx-prefix>
            <igx-icon>link</igx-icon>
          </igx-prefix>
          <input #strategyUrl igxInput placeholder="Link to a video/resource" [(ngModel)]="newStrategy.Url">
          <igx-suffix *ngIf="strategyUrl.value.length > 0" (click)="newStrategy.Url = ''">
              <igx-icon>clear</igx-icon>
          </igx-suffix>
        </igx-input-group>
      </igx-list-item>
      <igx-list-item *ngIf="getVideoEmbedLink()">
        <iframe width="560" height="315" [src]="sanitizedUrl" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </igx-list-item>
      <igx-list-item>
        <button igxButton igxRippleCentered="true" (click)="submitStrategy()" [disabled]="strategyName.invalid || strategyDescription.invalid">Submit</button>
      </igx-list-item>
    </igx-list>
  </div>
</igx-dialog>
<!-- END New strategy dialog -->

<app-success-error></app-success-error>